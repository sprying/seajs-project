define("widget/dialog/0.0.1/dialog",[],function(require,exports,module){if(!window.ysDialog){window.ysDialog={eventList:[]},require("./ysDialog.css");for(var isArray=$.isArray,isIE=util.browser.isIE,IE6=util.browser.isIE6,isCompat=$.browser.isCompat,isObj=$.isPlainObject,useFixed=!isIE||!IE6&&isCompat,initFn=["setDefaultCfg","show"],_initFn={},t;t=initFn.shift();)ysDialog[t]=eval("0,function(){_initFn."+t+"?_initFn."+t+".push(arguments):(_initFn."+t+"=[arguments])}");var btnIndex=0,btnCache,seed=0,addEvent=function(){return new Function("env","fn","obj","obj=obj||document;"+(window.attachEvent?"obj.attachEvent('on'+env,fn)":"obj.addEventListener(env,fn,false)")+";ysDialog.eventList.push([env,fn,obj])")}(),mkBtn=function(a,b,c,d,e){if(a){if(isArray(a)){for(var f,g=[],h={OK:[curCfg.okTxt,"ok"],CANCEL:[curCfg.cancelTxt,"cancel"]},i=a.slice();i.length;)(f=i.shift())&&g[g.push(mkBtn.apply(null,h[f]||f))-1]||g.pop();return g}return e=e||"ysDialog_btn_"+seed++,d=void 0==d?"undefined":!!d,{id:e,sign:b,autoClose:d,cls:c,html:"<input type='button' id='"+e+"'  style='cursor:pointer' class='btnStyle handler"+(c?" "+c:"")+"' value='"+a+"' />"}}},joinBtn=function(a){if(!a)return btnCache="";if(isArray(a)||(a=[a]),!a.length)return btnCache="";btnCache=a.concat();for(var b,c=[];a.length;)c.push(b=a.shift().html);return c.join("&nbsp;&nbsp;")},dftCfg={content:"内容",width:300,height:185,title:"标题",handler:function(){},maskAlphaColor:"#000",maskAlpha:.1,iframe:!1,icoCls:"",btn:null,autoClose:!0,fixPosition:!0,disableDrag:!1,dragOut:!1,titleBar:!0,showMask:!0,winPos:"c",winAlpha:.8,closeBtn:!0,showShadow:!1,useSlide:!1,slideCfg:{increment:.3,interval:50},closeTxt:"关闭",okTxt:" 确 定 ",cancelTxt:" 取 消 ",msgCls:"ys-content",minBtn:!1,minTxt:"最小化",maxBtn:!1,maxTxt:"最大化",allowSelect:!1,allowRightMenu:!1,noHeight:!1},curCfg={};!function(){var rootEl=document.body,callee=arguments.callee;if(!rootEl||"object"!=typeof rootEl)return addEvent("load",callee,window);if(isIE&&"complete"!=document.readyState)return addEvent("readystatechange",function(){"complete"==document.readyState&&callee()});rootEl=isCompat?document.documentElement:rootEl;var frameset=document.getElementsByTagName("frameset").length;if(isIE||!frameset){var getScrollPos=function(){return curCfg.fixPosition&&useFixed?[0,0]:[rootEl.scrollLeft,rootEl.scrollTop]},saveWinInfo=function(){var a=getScrollPos();$.extend(dragVar,{_offX:parseInt(ys_win.style.left)-a[0],_offY:parseInt(ys_win.style.top)-a[1]})},maskStyle="position:absolute;top:0;left:0;display:none;text-align:center",container=["<div id='maskLevel' style='"+maskStyle+";z-index:10000;'></div>",IE6?"<iframe id='maskIframe' src='' style='"+maskStyle+";z-index:9999;filter:alpha(opacity=0);opacity:0'></iframe>":"","<div id='ys-window' style='position:absolute;z-index:10001;display:none'>","<iframe src='' frameborder='0' border='0' style='width:100%;height:100%;position:absolute;top:0;left:0;z-index:-1;border: none;'></iframe>","<div class='ys-tl' id='ys-tl'><div class='ys-tr'><div class='ys-tc' style='cursor:move;'><div class='ys-header-text'></div><div class='ys-header-tools'>","<div class='ysDialog_min' title='最小化'><strong>0</strong></div>","<div class='ysDialog_max' title='最大化'><strong>1</strong></div>","<div class='ysDialog_close' title='关闭'><strong>x</strong></div>","</div></div></div></div>","<div class='ys-ml' id='ys-ml'><div class='ys-mr'><div class='ys-mc'><div class='ys-body' style='position:relative'></div></div></div></div>","<div class='ys-ml' id='ys-btnl'><div class='ys-mr'><div class='ys-btn'></div></div></div>","<div class='ys-bl' id='ys-bl'><div class='ys-br'><div class='ys-bc'></div></div></div>","</div>",isIE?"<div id='ys-shadow' style='position:absolute;z-index:10000;background:#808080;filter:alpha(opacity=80) progid:DXImageTransform.Microsoft.Blur(pixelradius=2);display:none'></div>":""].join("");$(document.body).append(container);var maskLevel=$("#maskLevel")[0],ys_win=$("#ys-window")[0],ys_shadow=$("#ys-shadow")[0],ys_wins,ys_headbox=$("#ys-tl")[0],ys_head=ys_headbox.firstChild.firstChild,ys_hText=ys_head.firstChild,ys_hTool=ys_hText.nextSibling,ys_body=$("#ys-ml")[0].firstChild.firstChild.firstChild,ys_btn=$("#ys-btnl")[0],ys_btnContent=ys_btn.firstChild.firstChild,ys_bottom=$("#ys-bl")[0],maskEl=[maskLevel];IE6&&maskEl.push($("#maskIframe")[0]);var ys_ico=ys_hTool.childNodes,dragVar={},cur_state="normal",cur_cord=[0,0],cal_cord=function(){var a=getScrollPos();cur_cord=[parseInt(ys_win.style.left)-a[0],parseInt(ys_win.style.top)-a[1]]},doMax=function(){cal_cord(),cur_state="max",ys_ico[1].firstChild.innerHTML="2",ys_ico[1].className="ysDialog_normal",setWinSize(rootEl.clientWidth,rootEl.clientHeight,[0,0])},doMin=function(){cal_cord(),cur_state="min",ys_ico[0].firstChild.innerHTML="2",ys_ico[0].className="ysDialog_normal",setWinSize(0,$(ys_headbox).height(),cur_cord)},doNormal=function(a){!a&&"min"==cur_state&&cal_cord(),cur_state="normal",ys_ico[0].firstChild.innerHTML="0",ys_ico[1].firstChild.innerHTML="1",ys_ico[0].className="ysDialog_min",ys_ico[1].className="ysDialog_max",setWinSize.apply(this,a?[]:[0,0,cur_cord])},max,min;$(ys_ico[0]).on("click",function(){"normal"!=cur_state?doNormal():doMin()}),$(ys_ico[1]).on("click",function(){"normal"!=cur_state?doNormal():doMax()}),$(ys_ico[2]).on("click",function(){ysDialog.doHandler("close")}),$(ys_head).on("dblclick",function(a){curCfg.maxBtn&&(a.srcElement||a.target).parentNode!=ys_hTool&&max()});var getWinSize=function(){return[Math.max(rootEl.scrollWidth,rootEl.clientWidth),Math.max(rootEl.scrollHeight,rootEl.clientHeight)]},winSize=getWinSize(),bindEl=ys_head.setCapture&&ys_head,filterWin=function(a){!frameset&&$(ys_win).css(1==a&&isCompat?{filter:"",opacity:""}:{filter:"Alpha(opacity="+100*a+")",opacity:a})},mEvent=function(a){var b=dragVar.offX+a.clientX,c=dragVar.offY+a.clientY;if(curCfg.dragOut)curCfg.showMask&&""+winSize!=""+getWinSize()&&resizeMask(!0);else{var d=getScrollPos(),e=d[0],f=d[1];b=Math.min(Math.max(b,e),rootEl.clientWidth-ys_win.offsetWidth+e),c=Math.min(Math.max(c,f),rootEl.clientHeight-ys_win.offsetHeight+f)}$(ys_wins).css({left:b+"px",top:c+"px"})},uEvent=function(){filterWin(1),$(bindEl||window).off("mousemove",mEvent),$(bindEl||window).off("mouseup",uEvent),saveWinInfo(),curCfg.iframe&&setStyle(getPage().nextSibling,"display","none"),curCfg.iframe&&$(getPage().nextSibling).css("display","none"),bindEl&&($(bindEl).off("losecapture",uEvent),bindEl.releaseCapture())};$(ys_head).on("mousedown",function(a){if(curCfg.disableDrag)return!1;if((a.srcElement||a.target).parentNode==ys_hTool)return!1;if(filterWin(curCfg.winAlpha),$.extend(dragVar,{offX:parseInt(ys_win.style.left)-a.clientX,offY:parseInt(ys_win.style.top)-a.clientY}),$(bindEl||window).on("mousemove",mEvent),$(bindEl||window).on("mouseup",uEvent),curCfg.iframe){var b={display:""},c=getPage();isCompat&&IE6&&$.extend(b,{width:c.offsetWidth,height:c.offsetHeight}),$(c.nextSibling).css(b)}bindEl&&($(bindEl).on("losecapture",uEvent),bindEl.setCapture())});var scrollEvent=function(){$(ys_win).css({left:dragVar._offX+rootEl.scrollLeft+"px",top:dragVar._offY+rootEl.scrollTop+"px"})},keydownEvent=function(a){var b=a.keyCode;if(27==b&&destroy(),btnCache){var c,d=btnCache.length;if(document.activeElement&&document.activeElement.id!=btnCache[btnIndex].id&&(c=!0),(9==b||39==b)&&(c&&(btnIndex=-1),$(btnCache[++btnIndex==d?--btnIndex:btnIndex].id).focus()),37==b&&(c&&(btnIndex=d),$(btnCache[--btnIndex<0?++btnIndex:btnIndex].id).focus()),13==b)return!0}return keyEvent(a,13==b,b>110&&124>b)},keyEvent=function(a,b,c){if(a=a||event,!b&&/input|select|textarea/i.test((a.srcElement||a.target).tagName))return!0;if(c)return!0;try{a.returnValue=!1,a.keyCode=0}catch(d){a.preventDefault&&a.preventDefault()}return!1};maskLevel.oncontextmenu=keyEvent;var resizeMask=function(a){$(maskEl).css("display","none");var b=getWinSize(),c=function(){$(maskEl).css({width:b[0]+"px",height:b[1]+"px",display:""})};isIE?a===!0?c():setTimeout(c,0):c(),"min"==cur_state?doMin():"max"==cur_state?doMax():setWinSize()},maskVisible=function(a){if(curCfg.showMask){if(a===!1)return $(window).off("resize",resizeMask),$(maskEl).css("display","none");$(window).on("resize",resizeMask),$(maskLevel).css({background:curCfg.maskAlphaColor,filter:"Alpha(opacity="+100*curCfg.maskAlpha+")",opacity:curCfg.maskAlpha}),resizeMask(!0)}},getPos=function(f){f=isArray(f)&&2==f.length?f[0]+"+{2},{3}+"+f[1]:posMap[f]||posMap.c;var pos=[rootEl.clientWidth-ys_win.offsetWidth,rootEl.clientHeight-ys_win.offsetHeight].concat(getScrollPos()),arr=f.replace(/\{(\d)\}/g,function(a,b){return pos[b]}).split(",");return[eval(arr[0]),eval(arr[1])]},posMap={c:"{0}/2+{2},{1}/2+{3}",l:"{2},{1}/2+{3}",r:"{0}+{2},{1}/2+{3}",t:"{0}/2+{2},{3}",b:"{0}/2,{1}+{3}",lt:"{2},{3}",lb:"{2},{1}+{3}",rb:"{0}+{2},{1}+{3}",rt:"{0}+{2},{3}"},setWinSize=function(a,b,c){if("none"!=ys_win.style.display){if(b=parseInt(b)||curCfg.height,a=parseInt(a)||curCfg.width,curCfg.noHeight?$(ys_wins).css({width:a+"px",height:"auto",left:0,top:0}):$(ys_wins).css({width:a+"px",height:b+"px",left:0,top:0}),c=getPos(c||curCfg.winPos),curCfg.noHeight){var d=.2*getWinSize()[1];$(ys_wins).css({top:d+"px",left:c[0]+"px"})}else $(ys_wins).css({top:c[1]+"px",left:c[0]+"px"});saveWinInfo(),curCfg.noHeight?$(ys_body).css("height","auto").css("max-height",.6*getWinSize()[1]+"px"):$(ys_body).css("height",b-$(ys_headbox).height()-$(ys_btn).height()-$(ys_bottom).height()+"px"),isCompat&&IE6&&curCfg.iframe&&$(getPage()).css({height:ys_body.clientHeight})}};$(ys_btnContent).on("click",function(a){for(var b=0,c=btnCache.length;c>b;b++){var d=btnCache[b];if($(a.target).attr("id")===d.id){ysDialog.fire(d.sign)!==!1&&ysDialog.doHandler(d.sign,d.autoClose);break}}});var _obj=[],cacheWin=[],winVisible=function(a){var b=a===!1?"off":"on";if($(window)[b]("scroll",curCfg.fixPosition&&!useFixed?scrollEvent:saveWinInfo),$(ys_wins).css("position",curCfg.fixPosition&&useFixed?"fixed":"absolute"),$(window)[b]("keydown",keydownEvent),a===!1){$(ys_shadow).css("display","none");var c=function(){$(ys_win).css("display","none"),$(_obj).css("visibility","visible"),_obj=[],cacheWin.shift(),cacheWin.length&&ysDialog.show.apply(null,cacheWin[0].concat(!0,!0))},d=function(){var a=1,b=function(){a=Math.max(a-curCfg.slideCfg.increment,0),filterWin(a),0==a&&(maskVisible(!1),c(),clearInterval(d))};b();var d=setInterval(b,curCfg.slideCfg.interval)};return curCfg.useSlide?d():c(),void 0}for(var e=document.getElementsByTagName("object"),f=e.length-1;f>-1;f--)"hidden"!=e[f].style.visibility&&_obj.push(e[f]);$([ys_hText,ys_hTool]).css("display",curCfg.titleBar?"":"none"),ys_head.className="ys-tc"+(curCfg.titleBar?"":" ys-ttc"),ys_hText.innerHTML=curCfg.title;for(var f=0,g=["min","max","close"];3>f;f++)ys_ico[f].style.display=curCfg[g[f]+"Btn"]?"":"none",ys_ico[f].title=curCfg[g[f]+"Txt"];var h="position:absolute;width:100%;height:100%;top:0;left:0;opacity:1;filter:alpha(opacity=100)";ys_body.innerHTML=curCfg.iframe?"<iframe style='"+h+"' border='0' frameborder='0' src='"+curCfg.content+"'></iframe><div style='"+h+";background:#000;opacity:0.1;filter:alpha(opacity=10);display:none'></div>":'<div class="'+curCfg.msgCls+'">'+curCfg.content+"</div>",function(a,b){for(var c in b)try{a[c]=b[c]}catch(d){}}(ys_body.firstChild,curCfg.iframe),ys_body.className="ys-body "+curCfg.icoCls,$(ys_btn).css("display",(ys_btnContent.innerHTML=joinBtn(mkBtn(curCfg.btn)))?"":"none"),!curCfg.useSlide&&curCfg.showShadow&&$(ys_shadow).css("display",""),$(ys_win).css("display",""),doNormal(!0),filterWin(curCfg.useSlide?0:1),curCfg.useSlide&&function(){var a=0,b=function(){a=Math.min(a+curCfg.slideCfg.increment,1),filterWin(a),1==a&&(clearInterval(c),curCfg.showShadow&&$(ys_shadow).css("display",""))};b();var c=setInterval(b,curCfg.slideCfg.interval)}(),btnCache&&$(btnCache[btnIndex=0].id).focus(),ys_win.onselectstart=curCfg.allowSelect?null:keyEvent,ys_win.oncontextmenu=curCfg.allowRightMenu?null:keyEvent},init=function(){ys_wins=[ys_win].concat(curCfg.showShadow?ys_shadow:""),maskVisible(),winVisible()},destroy=function(){!curCfg.useSlide&&maskVisible(!1),winVisible(!1)},getPage=function(){return curCfg.iframe?ys_body.firstChild:null};$.extend(ysDialog,{close:function(){destroy(),ysDialog.fire("hide"),ysDialog.offAll()},max:max,min:min,normal:doNormal,getPage:getPage,getContent:function(){return ys_body.firstChild||""},show:function(a,b,c,d){if(!(!c&&cacheWin.push([a,b])&&cacheWin.length>1)){!d&&c&&(cacheWin.length&&($(this.getContent()).find("input,textarea").each(function(){var a=$(this);"INPUT"==a[0].tagName?a.attr("value",a.val()):"TEXTAREA"==a[0].tagName&&a.text(a.val())}),cacheWin[0][0][0].content=$(this.getContent()).html()),cacheWin.unshift([a,b]));var e=[].slice.call(a,0),f={},g=-1;if(isObj(e[0]))f=e[0];else for(var h in dftCfg)e[++g]&&(f[h]=e[g]);$.extend(curCfg,ysDialog.setDefaultCfg(),$.extend({},b,f));for(var h in curCfg)curCfg[h]=null!=curCfg[h]?curCfg[h]:ysDialog.cfg[h];init(),curCfg.contentBind&&curCfg.contentBind()}},doHandler:function(a,b){if(void 0==b?curCfg.autoClose:b)curCfg.handler(a)!==!1&&(destroy(),curCfg.closeHandler&&curCfg.closeHandler(),ysDialog.fire("hide"),ysDialog.offAll());else try{curCfg.handler(a)}catch(c){alert(c.message)}},resizeWin:setWinSize,setDefaultCfg:function(a){return ysDialog.cfg=$.extend({},$.extend({},dftCfg,ysDialog.cfg),a)},getButtons:function(){for(var a,b=btnCache||[],c=[];a=b.shift();)c.push($(a.id));return c}}),ysDialog.setDefaultCfg();var t;for(var i in _initFn)for(;t=_initFn[i].shift();)ysDialog[i].apply(null,t)}}(),$.extend(ysDialog,{warn:function(){var a=[];1!=arguments.length||$.isPlainObject(arguments[0])?a=arguments:(a[0]={})&&(a[0].content=arguments[0]),ysDialog.show(a,{icoCls:"ysDialog_warn",title:"提示",btn:["OK"],width:300,height:135,maskAlpha:.4},!0,!1)},succeedInfo:function(){var a=[];1!=arguments.length||$.isPlainObject(arguments[0])?a=arguments:(a[0]={})&&(a[0].content=arguments[0]),ysDialog.show(a,{icoCls:"ysDialog_succeed",title:"提示",btn:["OK"],width:300,height:150,maskAlpha:.4})},tip:function(){var a=[];1!=arguments.length||$.isPlainObject(arguments[0])?a=arguments:(a[0]={})&&(a[0].content=arguments[0]),ysDialog.show(a,{icoCls:"ysDialog_tip",title:"提示",btn:["OK"],width:300,height:150,maskAlpha:.4})},errorInfo:function(){var a=[];1!=arguments.length||$.isPlainObject(arguments[0])?a=arguments:(a[0]={})&&(a[0].content=arguments[0]),ysDialog.show(a,{icoCls:"ysDialog_error",title:"提示",btn:["OK"],width:300,height:135,maskAlpha:.4})},win:function(){ysDialog.show(arguments)}},Base.Event),module.exports=ysDialog}});